<style>body,html{margin:0;padding:0;background-color:#000}div{position:absolute;top:0;bottom:0;left:0;right:0}#canvas{width:100%;height:100%}</style><div><canvas id="canvas"></canvas></div><script>!function(){"use strict";const t={t:0,i:.5*Math.PI,s:Math.PI,h:1.5*Math.PI,o:2*Math.PI,l:32,u:32,p:0,M:1,m:2,g:3,q:9};class i{constructor(t,i){this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=i,this.v=this.canvas.getContext("2d")}}const s={x:0,y:0,w:32,R:32},h={x:0,y:32,w:236,R:6},e={x:0,y:38,w:9,R:9},r={x:0,y:47,w:109,R:9},a={x:109,y:47,w:109,R:9},l={x:0,y:56,w:6,R:7},n={x:6,y:56,w:6,R:7},o={x:0,y:63,w:32,R:32},f={x:32,y:63,w:32,R:32},y={x:0,y:95,w:8,R:8},c={x:0,y:146,w:32,R:32},w={x:0,y:253,w:32,R:32},u={x:32,y:253,w:32,R:32},x={x:64,y:253,w:32,R:32},M={x:128,y:253,w:32,R:32},p={x:160,y:253,w:32,R:32},d={x:192,y:253,w:32,R:32},L={x:224,y:253,w:32,R:32};class g{static L(t,i,s,h){t.drawImage(i.T,s-i.anchor.x,h-i.anchor.y)}static A(t,i,s,h){t.v.drawImage(i.T,s.x-i.anchor.x-h.x+t.I.D,s.y-i.anchor.y-h.y+t.I.k)}static B(t,i,s,h){t.strokeStyle="rgba(0, 255, 0, 0.5)",t.strokeRect(s-i.anchor.x+i.O[0].x,h-i.anchor.y+i.O[0].y,i.O[1].x-i.O[0].x,i.O[1].y-i.O[0].y)}static H(t,i,s,h){i.C&&(t.strokeStyle="rgba(255, 0, 0, 0.7)",t.strokeRect(s-i.anchor.x+i.C[0].x,h-i.anchor.y+i.C[0].y,i.C[1].x-i.C[0].x,i.C[1].y-i.C[0].y))}static N(t,i,s){let h=t.O[1].x-t.O[0].x,e=t.O[1].y-t.O[0].y,r=(h>e?h:e)/2;return{x:i-t.anchor.x+(t.O[0].x+t.O[1].x)/2,y:s-t.anchor.y+(t.O[0].y+t.O[1].y)/2,r:r}}static S(t,i,s){return this.P(t.anchor,t.O,i,s)}static U(t,i,s){return this.P(t.anchor,t.C,i,s)}static P(t,i,s,h){return{x:s,y:h,_:[{x:i[0].x-t.x,y:i[0].y-t.y},{x:i[1].x-t.x,y:i[0].y-t.y},{x:i[1].x-t.x,y:i[1].y-t.y},{x:i[0].x-t.x,y:i[1].y-t.y}]}}}const b=.7071067811865475;class R{constructor(t){this.F=t,this.map=[],this.map[88]=N.V.W,this.map[90]=N.V.j,this.map[67]=N.V.G,this.map[32]=N.V.$,this.map[38]=N.V.K,this.map[40]=N.V.Y,this.map[37]=N.V.J,this.map[39]=N.V.X,this.map[87]=N.V.K,this.map[83]=N.V.Y,this.map[65]=N.V.J,this.map[68]=N.V.X,this.map[27]=N.V.Z,this.map[77]=N.V.tt,this.map[70]=N.V.it,this.map[80]=N.V.it,this.st=[{x:0,y:0,ht:0},{x:0,y:-1,ht:1},{x:0,y:1,ht:1},{x:0,y:0,ht:0},{x:-1,y:0,ht:1},{x:-b,y:-b,ht:1},{x:-b,y:b,ht:1},{x:-1,y:0,ht:1},{x:1,y:0,ht:1},{x:b,y:-b,ht:1},{x:b,y:b,ht:1},{x:1,y:0,ht:1},{x:0,y:0,ht:0},{x:0,y:-1,ht:1},{x:0,y:1,ht:1},{x:0,y:0,ht:0}],this.et=[],this.e()}async init(){window.addEventListener("keydown",t=>{let i=this.map[t.keyCode];console.log(t.keyCode),i&&(this.et[i]=!0)}),window.addEventListener("keyup",t=>{let i=this.map[t.keyCode];i&&(this.et[i]=!1)})}a(){let t=(this.et[N.V.K]?1:0)+(this.et[N.V.Y]?2:0)+(this.et[N.V.J]?4:0)+(this.et[N.V.X]?8:0);this.n=this.st[t]}e(){this.n=this.st[0];for(let t of Object.values(N.V))this.et[t]=!1}}const k=new class{async init(){this.canvas=document.getElementById("canvas"),this.v=this.canvas.getContext("2d"),this.resize(!0)}resize(t){let i=window.devicePixelRatio,s=this.canvas.clientWidth,h=this.canvas.clientHeight,e=s*i,r=h*i;(t||this.canvas.width!==e||this.canvas.height!==r)&&(this.canvas.width=e,this.canvas.height=r,this.scale=Math.floor(10*Math.max(e/480,r/270))/10,this.width=Math.ceil(this.canvas.width/this.scale),this.height=Math.ceil(this.canvas.height/this.scale),this.I={D:Math.floor(this.width/2),k:Math.floor(this.height/2)},this.clientWidth=s,this.clientHeight=h,this.v.imageSmoothingEnabled=!1,k.canvas.style.cursor="none")}};class m{constructor(t){this.F=t,this.map=[],this.map[0]=N.V.W,this.map[2]=N.V.rt,this.et=[],this.e()}async init(){return window.addEventListener("mousemove",t=>{this.at||(this.at={}),this.at.D=Math.floor(t.clientX*k.width/k.clientWidth),this.at.k=Math.floor(t.clientY*k.height/k.clientHeight)}),window.addEventListener("mouseout",()=>{this.at=void 0}),window.addEventListener("mousedown",t=>{let i=this.map[t.button];i&&(this.et[i]=!0)}),window.addEventListener("mouseup",t=>{let i=this.map[t.button];i&&(this.et[i]=!1)}),window.addEventListener("click",t=>{t.preventDefault()}),window.addEventListener("contextmenu",t=>{let i=this.map[t.button];console.log(t.button),i&&(this.et[i]=!0),this.nt=2,t.preventDefault()}),this}a(){this.nt&&(this.nt--,0===this.nt&&(this.et[N.V.rt]=!1,console.log("released")))}e(){this.at=void 0;for(let t of Object.values(N.V))this.et[t]=!1}}class N{async init(){this.n={x:0,y:0,ht:0},this.pressed={},this.ot={},this.et={},this.lt={},this.ct=new R(this),await this.ct.init(),this.yt=new m(this),await this.yt.init()}a(){this.ct.a(),this.yt.a();for(let t of Object.values(N.V)){let i=this.yt.et[t]||this.ct.et[t];this.pressed[t]=!this.et[t]&&i,this.ot[t]=this.et[t]&&!i,this.pressed[t]?this.lt[t]=1:this.et[t]&&i&&this.lt[t]++,this.et[t]=i}this.at=this.yt.at,this.n=this.ct.n}ft(t){}wt(t){}}N.V={K:11,Y:12,J:13,X:14,W:21,rt:30,j:22,G:23,$:24,Z:96,tt:97,it:98};const v={xt:(()=>{let t=[];for(let i=0;i<=360;i++)t[i]=2*Math.PI*i/360;return t})(),ut(t){let i=Math.sqrt(t.x*t.x+t.y*t.y);return 0===i?{x:0,y:0,ht:0}:{x:t.x/i,y:t.y/i,ht:i}},pt:(t,i)=>v.ut({x:i.x-t.x,y:i.y-t.y}),dt:(t,i)=>({x:Math.cos(t),y:Math.sin(t),ht:i||1}),Mt(t){let i=Math.atan2(t.y,t.x);return i<0&&(i+=v.xt[360]),i},gt:t=>({x:t.x*(t.ht||1),y:t.y*(t.ht||1)}),qt:(t,i)=>([t,i]=[v.gt(t),v.gt(i)],t.x*i.x+t.y*i.y),Et(...t){let i={x:0,y:0,ht:1};for(let s of t)i.x+=s.x*(s.ht||1),i.y+=s.y*(s.ht||1);return i},bt(t,i,s){for(i>s&&([i,s]=[s,i]);t>=s+v.xt[360];)t-=v.xt[360];for(;t<=i-v.xt[360];)t+=v.xt[360];return t>=i&&t<s},vt(t,i,s,h){for(console.log([t,i,s,h].map(t=>360*t/(2*Math.PI))),t>i&&([t,i]=[i,t]),s>h&&([s,h]=[h,s]);h>=i+v.xt[360];)h-=v.xt[360],s-=v.xt[360];for(;s<=t-v.xt[360];)s+=v.xt[360],h+=v.xt[360];const e=[Math.max(t,s),Math.min(i,h)];return console.log([t,i,s,h,...e].map(t=>360*t/(2*Math.PI))),e[0]>e[1]?void 0:e},Rt:i=>({Lt:i.x/t.l|0,r:i.y/t.u|0}),Tt:i=>({x:i.Lt*t.l,y:i.r*t.u}),At:t=>({D:t.x+k.I.D-K.It.Dt.x,k:t.y+k.I.k-K.It.Dt.y}),kt:(t,i,s)=>t<i?i:t>s?s:t,Bt(t,i){let s,h,e=i-t;return 0===e?(h=NaN,s=1/0):e>0?(h=1/e,s=(1-(t-Math.floor(t)))*h):(h=-1/e,s=(t-Math.floor(t))*h),{next:s,step:h}},*Ot(i,s){let h=i.x/t.l,e=i.y/t.u,r=s.x/t.l,a=s.y/t.u,l=Math.abs(Math.floor(h)-Math.floor(r))+Math.abs(Math.floor(e)-Math.floor(a));if(yield{Lt:0|h,r:0|e,ht:0},l>1){let t=h,i=e,s=0,n=Math.sign(r-h),o=Math.sign(a-e),f=v.Bt(h,r),y=v.Bt(e,a);for(let h=0;h<l-1;h++)f.next<y.next?(t+=n,s+=n,f.next+=f.step):(i+=o,s+=o,y.next+=y.step),yield{Lt:0|t,r:0|i,ht:s}}l>0&&(yield{Lt:0|r,r:0|a,ht:1})},*Ht(t,i){yield*v.Ot(t,v.Et(t,i))},*Ct(i){for(let s=Math.floor(i[0].y/t.u);s*t.u<i[1].y;s++)for(let h=Math.floor(i[0].x/t.l);h*t.l<i[1].x;h++)yield{Lt:h,r:s}},*Nt(t,i,s){let h=[{x:Math.min(t.x,i.x)-s,y:Math.min(t.y,i.y)-s},{x:Math.max(t.x,i.x)+s,y:Math.max(t.y,i.y)+s}];yield*v.Ct(h)},*St(t,i,s){yield*v.Nt(t,{x:t.x+i.x,y:t.y+i.y},s)},Pt(t,i,s,h){if(Math.max(t.x,i.x)+s<h[0].x||Math.min(t.x,i.x)-s>h[1].x||Math.max(t.y,i.y)+s<h[0].y||Math.min(t.y,i.y)-s>h[1].y)return;let e=i.x-t.x,r=i.y-t.y,a=0===e?0:1/e,l=0===r?0:1/r,n=1/0,o=1/0;if(t.x-s<h[0].x&&i.x+s>h[0].x){let i=(h[0].x-s-t.x)*a;if(i>=0&&i<=1){let s=r*i+t.y;if(s>=h[0].y&&s<=h[1].y)return{x:e*i+t.x,y:s,Ut:i,_t:-1,Ft:0,Wt:h[0].x,zt:s}}n=h[0].x}if(t.x+s>h[1].x&&i.x-s<h[1].x){let l=(t.x-(h[1].x+s))*-a;if(l>=0&&l<=1){let s=r*l+i.y;if(s>=h[0].y&&s<=h[1].y)return{x:e*l+t.x,y:s,Ut:l,_t:1,Ft:0,Wt:h[1].x,zt:s}}n=h[1].x}if(t.y-s<h[0].y&&i.y+s>h[0].y){let i=(h[0].y-s-t.y)*l;if(i>=0&&i<=1){let s=e*i+t.x;if(s>=h[0].x&&s<=h[1].x)return{x:s,y:r*i+t.y,Ut:i,_t:0,Ft:-1,Wt:s,zt:h[0].y}}o=h[0].y}if(t.y+s>h[1].y&&i.y-s<h[1].y){let i=(t.y-(h[1].y+s))*-l;if(i>=0&&i<=1){let s=e*i+t.x;if(s>=h[0].x&&s<=h[1].x)return{x:s,y:r*i+t.y,Ut:i,_t:0,Ft:1,Wt:s,zt:h[0].y}}o=h[1].y}if(n===1/0&&o===1/0)return;n!==1/0&&o===1/0&&(o=r>0?h[1].y:h[0].y),o!==1/0&&n===1/0&&(n=e>0?h[1].x:h[0].x);let f=1/s,y=Math.sqrt(e*e+r*r),c=n-t.x,w=o-t.y,u=Math.sqrt(c*c+w*w),x=Math.acos((c*e+w*r)/(y*u));if(u<s)return;if(0===x){let i=(u-s)/y;if(i>1||i<0)return;let h=i*e+t.x,a=i*r+t.y,l=c/u,f=w/u;return isNaN(h)?void 0:{x:h,y:a,Ut:i,_t:l,Ft:f,Wt:n,zt:o}}let M=Math.sin(x),p=M*u*f;if(Math.abs(p)>1)return;let d=Math.PI-Math.asin(p),L=Math.PI-x-d,g=s*Math.sin(L)/M/y;if(g>1||g<0)return;let b=g*e+t.x,R=g*r+i.y,k=(b-n)*f,m=(R-o)*f;return isNaN(b)?void 0:{x:b,y:R,Ut:g,_t:k,Ft:m,Wt:n,zt:o}},Vt(t,i,s,h,e,r){[s,r]=[v.gt(s),v.gt(r)];let a={x:t.x+s.x,y:t.y+s.y},l={x:h.x+r.x,y:h.y+r.y},n=v.pt(a,l);if(n.ht<i+e)return{_t:n.x,Ft:n.y,ht:i+e-n.ht}},jt(t,i){let s=v.Gt(t[0].length,t.length,100);console.log(s[0][0]);let h=[{...i,$t:0}];for(;h.length>0;){let{Lt:i,r:e,$t:r}=h.shift();s[e][i]<=r||(s[e][i]=r++,t[e][i+1]&&s[e][i+1]>r&&h.push({Lt:i+1,r:e,$t:r}),t[e][i-1]&&s[e][i-1]>r&&h.push({Lt:i-1,r:e,$t:r}),t[e+1][i]&&s[e+1][i]>r&&h.push({Lt:i,r:e+1,$t:r}),t[e-1][i]&&s[e-1][i]>r&&h.push({Lt:i,r:e-1,$t:r}))}return console.log(["---",s,"---"]),s},Gt(t,i,s){let h="function"==typeof s?s:()=>s;return Array.from({length:i},()=>Array.from({length:t},h))},Kt:(t,i)=>!!K.Yt.Yt[i][t]},$={Jt:(t,i,s,h)=>()=>{let e=(t>>>=0)+(i>>>=0)|0;return t=i^i>>>9,i=(s>>>=0)+(s<<3)|0,e=e+(h=1+(h>>>=0)|0)|0,s=(s=s<<21|s>>>11)+e|0,(e>>>0)/4294967296},Xt(t){let i,s;for(i=0,s=1779033703^t.length;i<t.length;i++)s=Math.imul(s^t.charCodeAt(i),3432918353),s=s<<13|s>>>19;return()=>(s=Math.imul(s^s>>>16,2246822507),s=Math.imul(s^s>>>13,3266489909),(s^=s>>>16)>>>0)},seed(t){let i=this.Xt(t),s=this.Jt(i(),i(),i(),i());return(t,i)=>"number"==typeof t&&"number"==typeof i?Math.floor(s()*(i-t))+t:s()}},_=[{Lt:0,r:0},{Lt:0,r:-1},{Lt:0,r:1},{Lt:-1,r:0},{Lt:1,r:0}],F=[{Lt:0,r:-1},{Lt:0,r:1},{Lt:-1,r:0},{Lt:1,r:0}],W={Zt:(t,i,s)=>_.filter(h=>{let[e,r]=[i+h.Lt,s+h.r];return r>=0&&r<t.length&&e>=0&&e<t[0].length&&!t[r][e]}),Qt(t,i,s,h,e,r){let a=2*i(0,(s[1].Lt-h)/2)+1,l=2*i(0,(s[1].r-e)/2)+1,n=void 0;for(let i=0;i<e;i++)for(let s=0;s<h;s++)if(t[l+i][a+s]&&(r=n=t[l+i][a+s]),1===t[l+i][a+s])return;if(!(n&&i()>.01)){for(let i=0;i<e;i++)for(let s=0;s<h;s++)t[l+i][a+s]=r;return{Lt:a,r:l,width:h,height:e,ti:r}}},ii(t,i,s,h,e){let r=[{Lt:s,r:h}];for(t[h][s]=e;r.length>0;){let s=i()<.25?i(0,r.length):r.length-1,h=r[s];s!==r.length-1&&(r.splice(s,1),r.push(h));let a=F.filter(i=>4===W.Zt(t,h.Lt+i.Lt,h.r+i.r).length);if(0===a.length)r.splice(r.indexOf(h),1);else{let s=a[i(0,a.length)];t[h.r+s.r][h.Lt+s.Lt]=e,r.push({Lt:h.Lt+s.Lt,r:h.r+s.r}),console.log(r)}}},si(t,i){let s=[],h=[];for(let i=1;i<t.length-1;i++)for(let e=1;e<t.length-1;e++){let r,a,[l,n,o,f]=[t[i-1][e],t[i+1][e],t[i][e-1],t[i][e+1]];l&&n&&l!==n?(r=l,a=n):o&&f&&o!==f&&(r=o,a=f),r&&a&&(r>a&&([r,a]=[a,r]),s.push({Lt:e,r:i,hi:r,ei:a}),h.push(r,a))}let e=[...new Set(h)].map(t=>[t]);for(console.log(e);s.length>0;){let h=i(0,s.length),r=s.splice(h,1)[0];t[r.r][r.Lt]=r.hi;let a=e.find(t=>t.includes(r.hi)),l=e.find(t=>t.includes(r.ei));i()>.2&&(s=s.filter(t=>!(a.includes(t.hi)&&l.includes(t.ei)||l.includes(t.hi)&&a.includes(t.ei)))),a!==l&&(e.splice(e.indexOf(l),1),a.push(...l))}},ri(t,i){let s=[];for(let i=0;i<t.length;i++)for(let h=0;h<t[0].length;h++)t[i][h]&&W.Zt(t,h,i).length>=3&&s.push({Lt:h,r:i});for(;s.length>0;){let h=i(0,s.length),e=s.splice(h,1)[0];if(i()<.45){let s=F.filter(i=>W.Zt(t,e.Lt+i.Lt,e.r+i.r).length<=2&&e.Lt+i.Lt>=0&&e.Lt+i.Lt<t[0].length&&e.r+i.r>=0&&e.r+i.r<t.length),h=s[i(0,s.length)];if(h){t[e.r+h.r][e.Lt+h.Lt]=t[e.r][e.Lt];continue}}i()>.05&&(t[e.r][e.Lt]=0,F.forEach(i=>{let[h,r]=[e.Lt+i.Lt,e.r+i.r];t[r][h]&&W.Zt(t,h,r).length>=3&&h>=0&&h<t[0].length&&r>=0&&r<t.length&&s.push({Lt:h,r:r})}))}},ai:t=>t.reduce((t,i)=>(t[i.ti]=t[i.ti]||[],t[i.ti].push(i),t),{}),ni(i,s){let h=v.Gt(i[0].length,i.length,()=>(s()<.1?t.g:t.m)+256);for(let s=0;s<h.length;s++)for(let e=0;e<h[0].length;e++)if(i[s][e]){let r=(i[s-1][e-1]?0:256)+(i[s-1][e]?0:128)+(i[s-1][e+1]?0:64)+(i[s][e-1]?0:32)+(i[s][e]?0:16)+(i[s][e+1]?0:8)+(i[s+1][e-1]?0:4)+(i[s+1][e]?0:2)+(i[s+1][e+1]?0:1);h[s][e]=(r<<4)+t.p}return h},oi(t){let i=v.Gt(99,99,0),s=$.seed(t),h=1,e=W.Qt(i,s,[{Lt:0,r:0},{Lt:99,r:99}],11,9,h++);console.log(e);let r=[e];for(let t=0;t<100;t++){let t=2*s(3,4)+1,a=2*s(3,4)+1;e=W.Qt(i,s,[{Lt:0,r:0},{Lt:99,r:99}],t,a,h),e&&r.push(e),e&&e.ti===h&&h++}for(let t=0;t<100;t++){let t=2*s(2,4)+1,a=2*s(2,4)+1;e=W.Qt(i,s,[{Lt:0,r:0},{Lt:99,r:99}],t,a,h),e&&r.push(e),e&&e.ti===h&&h++}for(let t=0;t<100;t++){let t=2*s(1,4)+1,a=2*s(1,4)+1;e=W.Qt(i,s,[{Lt:0,r:0},{Lt:99,r:99}],t,a,h),e&&r.push(e),e&&e.ti===h&&h++}for(let t=1;t<99;t+=2)for(let e=1;e<99;e+=2)5===W.Zt(i,e,t).length&&W.ii(i,s,e,t,h++);W.si(i,s),W.ri(i,s);let a=v.jt(i,r[0]);return{Yt:i,li:W.ni(i,s),ci:s,yi:this.ai(r),fi:a}}},z={32:3,44:3,46:3,73:2},U={async init(){this.default=g.font.T,this.wi=this.xi(this.default,t=>{let i=t.createLinearGradient(0,0,0,this.default.height);return i.addColorStop(0,"rgba(240,134,51,1)"),i.addColorStop(1,"rgba(250,220,74,1)"),i}),this.ui=this.xi(this.default,"rgba(240, 240, 255, 0.25)")},pi(t,i,s,h,e=this.default,r=1){i=i.toUpperCase();for(let a=0;a<i.length;a++){let l=i.charCodeAt(a);t.drawImage(e,4*(l-32),0,3,5,s,h,3*r,5*r),s+=(z[l]||4)*r}},di(t,i,s,h,e=this.default,r=1){i=i.toUpperCase(),s-=this.Mi(i,r),this.pi(t,i,s,h,e,r)},mi(t,i,s,h,e,r,a=this.default,l=1){let n=s,o=h,f=i.toUpperCase().split(" ");for(let i of f){let h=this.Mi(i,l);n+h-s>e&&(n=s,o+=7*l),this.pi(t,i,n,o,a,l),n+=h+z[32]}},Mi:(t,i)=>t.split("").reduce((t,i)=>t+(z[i.charCodeAt(0)]||4),0)*i,xi(t,s){let h=new i(t.width,t.height);return h.v.fillStyle="function"==typeof s?s(h.v):s,h.v.fillRect(0,0,t.width,t.height),console.log(t.width,t.height,s,h),h.v.globalCompositeOperation="destination-in",h.v.drawImage(t,0,0),h.canvas}},j={gi(t,i){for(let s of v.Ot(t.Dt,i.Dt))if(!v.Kt(s.Lt,s.r))return!1;return!0}},O={IDLE:101,qi:102,Ei:103,bi:104,vi:105,Ri:106,W:201,rt:202,apply(t){for(let i of t)i.Li&&i.Li()}};class A{constructor(){this.Dt={x:0,y:0},this.Ti={x:0,y:0},this.Ai={x:0,y:-1,ht:0},this.Di=100,this.Ii=[],this.ki=11,this.Bi=.5}Li(){switch(this.state){case O.IDLE:j.gi(this,K.Oi)&&(this.state=O.Ei);break;case O.Ei:let t=v.pt(this.Dt,K.Oi.Dt);t.ht=v.kt(t.ht,0,1),this.Ti={x:t.x*t.ht,y:t.y*t.ht};break;case O.Ri:this.Ti={x:0,y:0,ht:0},this.Hi||(this.Hi=15),this.Hi--,this.Hi<1&&(this.Ci=!0);break;default:this.state=O.IDLE}}Ni(t){this.state===O.Ri?g.A(t,g.Si,this.Dt,K.It.Dt):g.A(t,g.Pi,this.Dt,K.It.Dt)}}class D{constructor(t,i){this.Dt={...t},this.angle=i,this.Ui=v.xt[70],this.range=55}Li(){if(this.Ut=(this.Ut||0)+1,3===this.Ut){let t=K.entities.filter(t=>t instanceof A);for(let i of t){let t=v.pt(this.Dt,i.Dt);if(t.ht>=this.range+i.ki)continue;let s=v.pt(this.Dt,{x:i.Dt.x-t.y*i.ki,y:i.Dt.y+t.x*i.ki}),h=v.pt(this.Dt,{x:i.Dt.x+t.y*i.ki,y:i.Dt.y-t.x*i.ki}),e=[v.Mt(s),v.Mt(h)];if(!v.vt(e[0],e[1],this.angle-this.Ui/2,this.angle+this.Ui/2))continue;let r=[];v.Et(this.Dt,v.dt(e[0],t.ht));for(let i of v.Ht(this.Dt,v.dt(e[0],t.ht)))if(!v.Kt(i.Lt,i.r)){r.push(i);break}for(let i of v.Ht(this.Dt,v.dt(e[1],t.ht)))if(!v.Kt(i.Lt,i.r)){r.push(i);break}r.length<2&&i.Ii.push({_i:25,Fi:t})}}this.Ut>6&&(this.Ci=!0)}Ni(t){let i=v.At(this.Dt);t.v.beginPath(),t.v.arc(i.D,i.k,this.range,this.angle-this.Ui/2,this.angle+this.Ui/2),t.v.lineTo(i.D,i.k),t.v.closePath(),t.v.fillStyle="rgba(255, 0, 0, 0.5)",t.v.fill()}}class E{constructor(t){this.Ut=-1,this.d=t,this.z=101}Li(){++this.Ut===this.d&&(this.Ci=!0)}Ni(t){for(let i=0;i<K.Oi.Wi;i++){let s=i*this.d/K.Oi.Wi,h=s-3;if(this.Ut>=h){let h=Math.min(10,10+this.Ut-s);t.v.globalAlpha=Math.min(1,1+(this.Ut-s)/10),t.v.drawImage(g.zi.T,15+6*i,h),t.v.globalAlpha=1}}}}class S{constructor(){this.Dt={x:0,y:0},this.Ti={x:0,y:0},this.Ai={x:0,y:-1,ht:0},this.Di=100,this.Ii=[],this.ki=12,this.Vi=4,this.Wi=4,this.Bi=3}Li(){switch(this.state){case O.bi:this.ji(1),K.input.pressed[N.V.W]&&(0===this.Vi?this.reload():this.wi()),K.input.pressed[N.V.rt]&&this.reload();break;case O.W:this.ji(1),--this.f<=0&&(this.state=O.bi);break;case O.rt:this.ji(2.5),--this.f<=0&&(this.Vi=this.Wi,this.state=O.bi);break;default:this.state=O.bi,this.f=0}}ji(t){K.Gi()&&(this.Ai=v.pt(this.Dt,K.Gi()));let i=K.input.n.x*K.input.n.ht*1.8*t,s=K.input.n.y*K.input.n.ht*1.8*t;this.Ti.x=(this.Ti.x+i)/2,this.Ti.y=(this.Ti.y+s)/2}Ni(i){g.A(i,g.Oi,this.Dt,K.It.Dt),i.v.strokeStyle="rgba(255, 255, 64, 0.3)",i.v.beginPath();let s=K.At(this.Dt);i.v.arc(s.D,s.k,t.q,0,2*Math.PI),i.v.setLineDash([2,1]),i.v.stroke(),i.v.setLineDash([])}wi(){this.state=O.W,this.f=6,this.Vi--;let t=v.Mt(this.Ai);K.entities.push(new D(this.Dt,t)),this.Ti=v.ut(this.Ai),this.Ti.ht=1}reload(){this.state=O.rt,this.f=12,K.entities.push(new E(this.f))}}const q={Ni(t){}},G={apply(t){let i=t.filter(t=>t.Dt&&t.Ti&&!t.Ci);for(let t=0;t<5;t++){for(let t=0;t<i.length-1;t++)for(let s=t+1;s<i.length;s++)this.$i(i[t],i[s]);for(let t of i)this.Ki(t)}for(let t of i)t.Dt.x+=t.Ti.x,t.Dt.y+=t.Ti.y},$i(t,i){let s=v.Vt(t.Dt,t.ki,t.Ti,i.Dt,i.ki,i.Ti);if(s){let h=v.ut(t.Ti).ht+i.Bi,e=v.ut(i.Ti).ht+t.Bi;t.Ti.x-=s._t*s.ht*h/(h+e),t.Ti.y-=s.Ft*s.ht*h/(h+e),i.Ti.x+=s._t*s.ht*e/(h+e),i.Ti.y+=s.Ft*s.ht*e/(h+e)}},Ki(i){for(let s of v.St(i.Dt,i.Ti,t.q))if(!v.Kt(s.Lt,s.r)){let h=[v.Tt(s),v.Tt({Lt:s.Lt+1,r:s.r+1})],e=v.Pt(i.Dt,{x:i.Dt.x+i.Ti.x,y:i.Dt.y+i.Ti.y},t.q,h);e&&(0===e._t?i.Ti.y=e.y-i.Dt.y:0===e.Ft?i.Ti.x=e.x-i.Dt.x:(i.Ti.x+=e._t,i.Ti.y+=e.Ft))}}},J={apply(t){for(let i of t)if("number"==typeof i.Di){if(i.Ii.length>0){for(let t of i.Ii)i.Di-=t._i,t.Fi.ht=10,i.Ti=v.Et(i.Ti,t.Fi);i.Ii=[]}i.Di<=0&&(i.state=O.Ri)}}},K=new class{constructor(){}async init(){k.init(),this.input=new N,await this.input.init(),this.Yt=W.oi("apples"),this.It={Dt:{x:1,y:1}},await class{static async init(){this.images={},g.font=await this.Yi("sprites.png",h),g.Oi=await this.Yi("sprites.png",c),g.Ji=await this.Yi("sprites.png",s),g.Pi=await this.Yi("sprites.png",o),g.Si=await this.Yi("sprites.png",f),g.Xi=await this.Yi("sprites.png",l),g.zi=await this.Yi("sprites.png",n),g.Zi=await this.Yi("sprites.png",r),g.Qi=await this.Yi("sprites.png",a),g.ts=await this.Yi("sprites.png",e),g.page=await this.Yi("sprites.png",y),g.li=[],g.li[t.p]=await this.Yi("sprites.png",x),g.li[t.m]=await this.Yi("sprites.png",w),g.li[t.g]=await this.Yi("sprites.png",u);let i=await this.Yi("sprites.png",M),b=await this.Yi("sprites.png",p),R=(await this.Yi("sprites.png",d),await this.Yi("sprites.png",L));g.ss=[],g.ss[32]=g.ss[288]=g.ss[36]=g.ss[292]=i,g.ss[8]=g.ss[72]=g.ss[9]=g.ss[73]=this.hs(this.es(i.T,t.s)),g.ss[128]=g.ss[384]=g.ss[192]=g.ss[448]=this.hs(this.es(i.T,t.i)),g.ss[8]=this.hs(this.es(i.T,t.s)),g.ss[2]=this.hs(this.es(i.T,t.h)),g.ss[160]=g.ss[416]=g.ss[224]=g.ss[480]=g.ss[228]=g.ss[164]=g.ss[228]=g.ss[484]=b,g.ss[136]=g.ss[200]=g.ss[392]=g.ss[456]=g.ss[137]=g.ss[201]=g.ss[457]=g.ss[393]=this.hs(this.es(b.T,t.i)),g.ss[10]=g.ss[11]=g.ss[14]=g.ss[15]=g.ss[74]=g.ss[75]=g.ss[78]=g.ss[79]=this.hs(this.es(b.T,t.s)),g.ss[34]=g.ss[35]=g.ss[38]=g.ss[39]=g.ss[290]=g.ss[291]=g.ss[294]=g.ss[295]=this.hs(this.es(b.T,t.h)),g.ss[256]=R,g.ss[64]=this.hs(this.es(R.T,t.i)),g.ss[1]=this.hs(this.es(R.T,t.s)),g.ss[4]=this.hs(this.es(R.T,t.h)),g.ss[320]=this.hs(this.rs(g.ss[256].T,g.ss[64].T)),g.ss[5]=this.hs(this.rs(g.ss[4].T,g.ss[1].T)),g.ss[260]=this.hs(this.rs(g.ss[256].T,g.ss[4].T)),g.ss[65]=this.hs(this.rs(g.ss[64].T,g.ss[1].T))}static async Yi(t,i,s){return this.hs(await this.as(t,i.x,i.y,i.w,i.R),s)}static es(t,s){let h=new i(t.width,t.height);return h.v.translate(t.width/2,t.height/2),h.v.rotate(s),h.v.translate(-t.width/2,-t.height/2),h.v.drawImage(t,0,0),h.canvas}static rs(...t){let s=new i(t[0].width,t[0].height);for(let i of t)s.v.drawImage(i,0,0);return s.canvas}static hs(t,i){let s=t.width,h=t.height;return{T:t,anchor:i&&i.anchor||{x:Math.floor(s/2),y:Math.floor(h/2)},O:i&&i.O||[{x:0,y:0},{x:s,y:h}],C:i&&i.C}}static async as(t,s,h,e,r){const a=await this.ns(t),l=new i(e,r);return l.v.drawImage(a,s,h,e,r,0,0,e,r),l.canvas}static async ns(t){return this.images[t]?this.images[t]:await new Promise((i,s)=>{let h=new Image;h.onload=()=>i(h),h.onerror=t=>s(t),h.src=t,this.images[t]=h})}}.init(),await U.init(),this.entities=[],this.Oi=new S,console.log(this.Yt.yi),this.Oi.Dt.x=(this.Yt.yi[1][0].Lt+Math.floor(this.Yt.yi[1][0].width/2))*t.l+t.l/2,this.Oi.Dt.y=(this.Yt.yi[1][0].r+Math.floor(this.Yt.yi[1][0].height/2))*t.l+t.l/2,this.entities.push(this.Oi)}start(){this.c=0,this.os=!0,this.a(),this.os=!1,window.requestAnimationFrame(()=>this.ls(1))}ls(t){this.c++,k.resize(),this.a(),this.Ni(k.v),window.requestAnimationFrame(()=>this.ls(t))}a(){this.input.a(),O.apply(this.entities),J.apply(this.entities),G.apply(this.entities);let t=this.Oi.Dt.x-this.It.Dt.x,i=this.Oi.Dt.y-this.It.Dt.y;this.It.Dt.x+=.2*t,this.It.Dt.y+=.2*i,this.cs(),this.entities=this.entities.filter(t=>!t.Ci)}cs(){if(this.entities.filter(t=>t instanceof A).length<4&&Math.random()<.1){let t=this.Yt.yi[1][0].Lt+this.Yt.ci(0,this.Yt.yi[1][0].width),i=this.Yt.yi[1][0].r+this.Yt.ci(0,this.Yt.yi[1][0].height),s=new A;s.Dt=v.Tt({Lt:t,r:i}),this.entities.push(s)}}Ni(t){t.setTransform(1,0,0,1,0,0),t.scale(k.scale,k.scale),t.fillStyle="rgba(48,32,48,1)",t.fillRect(0,0,k.width,k.height),this.ys(t,this.Yt),this.fs(t);for(let t of this.entities)t.Ni(k);q.Ni(k)}ys(t,i){let s=k.I.D-this.It.Dt.x,h=k.I.k-this.It.Dt.y;for(let e=0;e<i.li.length;e++)for(let r=0;r<i.li[e].length;r++){let a=32*r+s,l=32*e+h;if(a<-50||l<-50||a>500||l>500)continue;let n=g.li[15&i.li[e][r]];if(!n)throw new Error(`${r},${e} tile ${i.li[e][r]}`);t.drawImage(n.T,a,l),n=g.ss[i.li[e][r]>>4],n&&t.drawImage(n.T,a,l)}}Gi(){if(this.input.at)return this.ws(this.input.at)}At(t){return{D:t.x-this.It.Dt.x+k.I.D,k:t.y-this.It.Dt.y+k.I.k}}ws(t){return{x:t.D-k.I.D+this.It.Dt.x,y:t.k-k.I.k+this.It.Dt.y}}fs(t){let i=v.kt(K.Oi.Di,0,100);t.drawImage(g.Zi.T,2,2),t.drawImage(g.Qi.T,0,0,i+8,8,2,2,i+8,8);let s=g.zi;for(let i=0;i<K.Oi.Wi;i++)i+1>K.Oi.Vi&&(s=g.Xi),t.drawImage(s.T,15+6*i,10);t.drawImage(g.page.T,k.width-39,9),U.pi(t,"x302",k.width-30,10),U.di(t,[k.scale,k.width,k.height].join(", "),k.width-4,k.height-18);let h=this.input.at;h&&(U.di(t,JSON.stringify(h),k.width-4,k.height-8),g.L(t,g.ts,h.D,h.k))}};K.init().then(()=>K.start())}();
//# sourceMappingURL=app.js.map</script><script>// Generated using https://zzfx.3d2k.com/
if (typeof AudioContext === 'undefined') { AudioContext = webkitAudioContext }
// ZzFX - Zuper Zmall Zound Zynth - Minified Version - MIT License - Copyright 2019 Frank Force
function ZZFXLib(){this.x=new AudioContext;this.r=Date.now();this.buffer=0;this.volume=.5;this.randomness=.1}ZZFXLib.prototype.z=function(b,d){var a=this.Generate(b),c;for(c in d)a[c]=d[c];return this.Z(a.volume,a.randomness,a.frequency,a.length,a.attack,a.slide,a.noise,a.modulation,a.modulationPhase)};
ZZFXLib.prototype.Z=function(b,d,a,c,e,g,h,k,l){c=void 0===c?1:c;e=void 0===e?.1:e;g=void 0===g?0:g;h=void 0===h?0:h;k=void 0===k?0:k;l=void 0===l?0:l;b*=this.volume;a*=2*Math.PI/44100;a*=1+d*(2*this.R()-1);g*=1E3*Math.PI/Math.pow(44100,2);c=0<c?44100*(10<c?10:c)|0:1;e*=c|0;k*=2*Math.PI/44100;l*=Math.PI;d=[];for(var m=0,n=0,f=0;f<c;++f)d[f]=b*Math.cos(m*a*Math.cos(n*k+l))*(f<e?f/e:1-(f-e)/(c-e)),m+=1+h*(2*this.R()-1),n+=1+h*(2*this.R()-1),a+=g;this.buffer=d;b=this.x.createBuffer(1,d.length,44100);
a=this.x.createBufferSource();b.getChannelData(0).set(d);a.buffer=b;a.connect(this.x.destination);a.start();return a};
ZZFXLib.prototype.Generate=function(b){var d=this.r;this.r=b;for(var a=9;a--;)this.R();a={};a.seed=b;a.volume=1;a.randomness=b?this.randomness:0;a.frequency=b?2E3*Math.pow(this.R(),2)|0:220;a.slide=b?parseFloat((10*Math.pow(this.R(),3)).toFixed(1)):0;a.length=b?parseFloat((.1+this.R()).toFixed(1)):1;a.attack=b?parseFloat(this.R().toFixed(2)):.1;a.noise=b?parseFloat((5*Math.pow(this.R(),3)).toFixed(1)):0;a.modulation=b?parseFloat((99*Math.pow(this.R(),5)).toFixed(1)):0;a.modulationPhase=b?parseFloat(this.R().toFixed(2)):
0;this.r=d;return a};ZZFXLib.prototype.Note=function(b,d){return b*Math.pow(2,d/12)};ZZFXLib.prototype.R=function(){this.r^=this.r<<13;this.r^=this.r>>7;this.r^=this.r<<17;return Math.abs(this.r)%1E9/1E9};var ZZFX=new ZZFXLib;</script>